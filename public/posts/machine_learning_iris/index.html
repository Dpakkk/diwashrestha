<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Machine Learning Iris - Diwashrestha</title><meta name=Description content="Diwash Shrestha Personal Website"><meta property="og:title" content="Machine Learning Iris"><meta property="og:description" content="In this blog, we will use some machine learning concept with help of ScikitLearn a Machine Learning Package and Iris dataset which can be loaded from sci-kit learn. we will use numpy to work on the Iris dataset and Matplotlib for Visualization. Iris data set is a multivariate data set introduced by the British statistician and biologist Ronald Fisher in his 1936 paper. The use of multiple measurements in taxonomic problems as an example of linear discriminant analysis."><meta property="og:type" content="article"><meta property="og:url" content="http://diwashrestha.com.np/posts/machine_learning_iris/"><meta property="og:image" content="http://diwashrestha.com.np/images/bloglogo.png"><meta property="article:published_time" content="2017-09-18T19:37:45+05:45"><meta property="article:modified_time" content="2017-09-18T19:37:45+05:45"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://diwashrestha.com.np/images/bloglogo.png"><meta name=twitter:title content="Machine Learning Iris"><meta name=twitter:description content="In this blog, we will use some machine learning concept with help of ScikitLearn a Machine Learning Package and Iris dataset which can be loaded from sci-kit learn. we will use numpy to work on the Iris dataset and Matplotlib for Visualization. Iris data set is a multivariate data set introduced by the British statistician and biologist Ronald Fisher in his 1936 paper. The use of multiple measurements in taxonomic problems as an example of linear discriminant analysis."><meta name=application-name content="diwashrestha"><meta name=apple-mobile-web-app-title content="diwashrestha"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://diwashrestha.com.np/posts/machine_learning_iris/><link rel=prev href=http://diwashrestha.com.np/posts/population_analysis/><link rel=next href=http://diwashrestha.com.np/posts/eda_titanic/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Machine Learning Iris","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/diwashrestha.com.np\/posts\/machine_learning_iris\/"},"genre":"posts","wordcount":941,"url":"http:\/\/diwashrestha.com.np\/posts\/machine_learning_iris\/","datePublished":"2017-09-18T19:37:45+05:45","dateModified":"2017-09-18T19:37:45+05:45","description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem('theme')?localStorage.getItem('theme')==='dark':(''==='auto'?window.matchMedia('(prefers-color-scheme: dark)').matches:''==='dark'))&&document.body.setAttribute('theme','dark');</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Diwashrestha>DiwAsh ShresthA</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/me/ title="About Me">About Me </a><a class=menu-item href=/projects/>Projects </a><a class=menu-item href=/programstalks/>Program & Talks </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Diwashrestha>DiwAsh ShresthA</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/>Posts</a><a class=menu-item href=/me/ title="About Me">About Me</a><a class=menu-item href=/projects/>Projects</a><a class=menu-item href=/programstalks/>Program & Talks</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><article class="page single"><h1 class="single-title animated flipInX">Machine Learning Iris</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i></a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="Monday, Sep 18, 2017">Monday, Sep 18, 2017</time>&nbsp;
<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;about 941 words&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;5 min&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading/normal.min.svg data-src=/images/ml_on_iris/preview.png data-srcset="/images/ml_on_iris/preview.png, /images/ml_on_iris/preview.png 1.5x, /images/ml_on_iris/preview.png 2x" data-sizes=auto alt=/images/ml_on_iris/preview.png title=/images/ml_on_iris/preview.png></div><div class=content id=content><p>In this blog, we will use some machine learning concept with help of <a href=https://scikit-learn.org/stable/ target=_blank rel="noopener noreffer">ScikitLearn</a> a Machine Learning Package and Iris dataset which can be loaded from sci-kit learn. we will use numpy to work on the Iris dataset and Matplotlib for Visualization. Iris data set is a multivariate data set introduced by the British statistician and biologist Ronald Fisher in his 1936 paper. The use of multiple measurements in taxonomic problems as an example of linear discriminant analysis. The data set consists of 50 samples from each of three species of Iris:</p><ul><li>Iris setosa</li><li>Iris virginica</li><li>Iris versicolor</li></ul><p><img class=lazyload src=/svg/loading/small.min.svg data-src=/images/ml_on_iris/iris1.jpg data-srcset="/images/ml_on_iris/iris1.jpg, /images/ml_on_iris/iris1.jpg 1.5x, /images/ml_on_iris/iris1.jpg 2x" data-sizes=auto alt=/images/ml_on_iris/iris1.jpg title=/images/ml_on_iris/iris1.jpg></p><p>There are Four features or column about the flowe r.</p><ul><li>Sepal length(cm)</li><li>Sepal Width(cm)</li><li>Petal Length(cm)</li><li>Petal Width(cm)</li></ul><p><img class=lazyload src=/svg/loading/small.min.svg data-src=/images/ml_on_iris/iris2.jpg data-srcset="/images/ml_on_iris/iris2.jpg, /images/ml_on_iris/iris2.jpg 1.5x, /images/ml_on_iris/iris2.jpg 2x" data-sizes=auto alt=/images/ml_on_iris/iris2.jpg title=/images/ml_on_iris/iris2.jpg></p><p>Iris datasets are the basic Machine Learning data. The objective of this post is to find the species of Iris flower of test data using the trained model. we are using the Sklearn python package’s Decision tree.</p><h3 id=import-library-and-module>Import Library and Module</h3><p><img class=lazyload src=/svg/loading/small.min.svg data-src=/images/ml_on_iris/iris3.png data-srcset="/images/ml_on_iris/iris3.png, /images/ml_on_iris/iris3.png 1.5x, /images/ml_on_iris/iris3.png 2x" data-sizes=auto alt=/images/ml_on_iris/iris3.png title=/images/ml_on_iris/iris3.png></p><p>First, we will import the required library and module in the python console. In this machine learning we will use:</p><ul><li><p>Numpy: which provides support for more efficient numerical computation</p></li><li><p>Pandas: a convenient library that supports data frames.</p></li><li><p>Matplotlib &Seaborne: for Visualization</p></li><li><p>ScikitLearn: Machine learning tools</p></li></ul><h3 id=load-iris-data>Load Iris Data</h3><p>Now, we will load the iris data from the seaborne’s builtin dataset and print first 5 rows as follow:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>iris</span> <span class=o>=</span> <span class=n>sns</span><span class=o>.</span><span class=n>load_dataset</span><span class=p>(</span><span class=s2>&#34;iris&#34;</span><span class=p>)</span>
<span class=k>print</span><span class=p>(</span><span class=n>iris</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>sepal_length  sepal_width  petal_length  petal_width species
           5.1          3.5           1.4          0.2  setosa
           4.9          3.0           1.4          0.2  setosa
           4.7          3.2           1.3          0.2  setosa
           4.6          3.1           1.5          0.2  setosa
           5.0          3.6           1.4          0.2  setosa
</code></pre></td></tr></table></div></div><p>Lets look at the data</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=k>print</span> <span class=p>(</span><span class=n>iris</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>

<span class=c1>#(150, 5)</span>
</code></pre></td></tr></table></div></div><p>We have 150 samples and 5 features, including our target feature. we can easily print some summary statistics.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=k>print</span><span class=p>(</span><span class=n>iris</span><span class=o>.</span><span class=n>describe</span><span class=p>())</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>sepal_length  sepal_width  petal_length  petal_width
count    150.000000   150.000000    150.000000   150.000000
mean       5.843333     3.057333      3.758000     1.199333
std        0.828066     0.435866      1.765298     0.762238
min        4.300000     2.000000      1.000000     0.100000
25%        5.100000     2.800000      1.600000     0.300000
50%        5.800000     3.000000      4.350000     1.300000
75%        6.400000     3.300000      5.100000     1.800000
max        7.900000     4.400000      6.900000     2.500000
</code></pre></td></tr></table></div></div><p>The list of the features are :</p><ul><li>sepal length</li><li>sepal width</li><li>petal length</li><li>petal width</li></ul><h3 id=split-data-into-training-and-test-sets>Split data into training and test sets</h3><p><img class=lazyload src=/svg/loading/small.min.svg data-src=/images/ml_on_iris/iris4.png data-srcset="/images/ml_on_iris/iris4.png, /images/ml_on_iris/iris4.png 1.5x, /images/ml_on_iris/iris4.png 2x" data-sizes=auto alt=/images/ml_on_iris/iris4.png title=/images/ml_on_iris/iris4.png></p><p>We split the data into training and test sets at the beginning of modelling workflow. Splitting is crucial for getting a realistic estimate of the model’s performance.</p><p>First, let’s separate our target (y) features from our input (X) features:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>y</span> <span class=o>=</span> <span class=n>iris</span><span class=o>.</span><span class=n>species</span>
<span class=n>X</span> <span class=o>=</span> <span class=n>iris</span><span class=o>.</span><span class=n>drop</span><span class=p>(</span><span class=s1>&#39;species&#39;</span><span class=p>,</span><span class=n>axis</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>Now we use the Scikit learn train_test_split function:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>sklearn.model_selection</span> <span class=kn>import</span> <span class=n>train_test_split</span>
<span class=n>X_train</span><span class=p>,</span> <span class=n>X_test</span><span class=p>,</span> <span class=n>y_train</span><span class=p>,</span> <span class=n>y_test</span> <span class=o>=</span> <span class=n>train_test_split</span><span class=p>(</span><span class=n>X</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> 
                                                    <span class=n>test_size</span><span class=o>=</span><span class=mf>0.3</span><span class=p>,</span> 
                                                    <span class=n>random_state</span><span class=o>=</span><span class=mi>100</span><span class=p>,</span> 
                                                    <span class=n>stratify</span><span class=o>=</span><span class=n>y</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>We’ll set aside 30% of the data as a test set for evaluating the model. we also set an arbitrary “random state” so that the program can reproduce our results.</p><h3 id=visualization>Visualization</h3><p>Now we will plot the graph to understand the features and the species in data.we are using seaborne and matplotlib to make these graph plots.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>sns</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=n>style</span><span class=o>=</span><span class=s2>&#34;ticks&#34;</span><span class=p>)</span>
<span class=n>iris</span> <span class=o>=</span> <span class=n>sns</span><span class=o>.</span><span class=n>load_dataset</span><span class=p>(</span><span class=s2>&#34;iris&#34;</span><span class=p>)</span>
<span class=n>sns</span><span class=o>.</span><span class=n>pairplot</span><span class=p>(</span><span class=n>iris</span><span class=p>,</span> <span class=n>hue</span><span class=o>=</span><span class=s2>&#34;species&#34;</span><span class=p>,</span><span class=n>palette</span><span class=o>=</span><span class=s2>&#34;bright&#34;</span><span class=p>)</span>
<span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading/small.min.svg data-src=/images/ml_on_iris/iris5.png data-srcset="/images/ml_on_iris/iris5.png, /images/ml_on_iris/iris5.png 1.5x, /images/ml_on_iris/iris5.png 2x" data-sizes=auto alt=/images/ml_on_iris/iris5.png title=/images/ml_on_iris/iris5.png></p><p>The above graph is scatterplot which is plotted between four features of iris in 12 different plots. In the above picture, we can see the samples formed clusters according to their species.</p><p>In next graph, we will plot the 4 features of 3 iris species in barplot:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>piris</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>melt</span><span class=p>(</span><span class=n>iris</span><span class=p>,</span> <span class=s2>&#34;species&#34;</span><span class=p>,</span> <span class=n>var_name</span><span class=o>=</span><span class=s2>&#34;measurement&#34;</span><span class=p>)</span> <span class=n>sns</span><span class=o>.</span><span class=n>factorplot</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=s2>&#34;measurement&#34;</span><span class=p>,</span> <span class=n>y</span><span class=o>=</span><span class=s2>&#34;value&#34;</span><span class=p>,</span> <span class=n>hue</span><span class=o>=</span><span class=s2>&#34;species&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>piris</span><span class=p>,</span> <span class=n>size</span><span class=o>=</span><span class=mi>7</span><span class=p>,</span> <span class=n>kind</span><span class=o>=</span><span class=s2>&#34;bar&#34;</span><span class=p>,</span><span class=n>palette</span><span class=o>=</span><span class=s2>&#34;bright&#34;</span><span class=p>)</span> <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span> 
<span class=k>print</span><span class=p>(</span><span class=n>piris</span><span class=o>.</span><span class=n>head</span><span class=p>())</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>  species   measurement  value
  setosa  sepal_length    5.1
  setosa  sepal_length    4.9
  setosa  sepal_length    4.7
  setosa  sepal_length    4.6
  setosa  sepal_length    5.0
</code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading/small.min.svg data-src=/images/ml_on_iris/iris6.png data-srcset="/images/ml_on_iris/iris6.png, /images/ml_on_iris/iris6.png 1.5x, /images/ml_on_iris/iris6.png 2x" data-sizes=auto alt=/images/ml_on_iris/iris6.png title=/images/ml_on_iris/iris6.png></p><p>In the above code, we made a new variable piris to make the visualization easier. This picture shows how three species of iris differ on the basis of the four features.</p><h3 id=decision-tree>Decision tree</h3><p>Decision tree algorithm is a simple supervised learning algorithm which is used in regression and classification problems. we will make Decision Tree classifier and fit training data (X_train and y_train) to train the model.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>clf</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>DecisionTreeClassifier</span><span class=p>()</span>
<span class=n>clf</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>X_train</span><span class=p>,</span><span class=n>y_train</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>DecisionTreeClassifier(class_we ight=None, criterion=&#39;gini&#39;, max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_split=1e-07, min_samples_leaf=1,
            min_samples_split=2, min_we ight_fraction_leaf=0.0,
            presort=False, random_state=None, splitter=&#39;best&#39;)
</code></pre></td></tr></table></div></div><p>After fitting the training data the Decision_tree classifier makes a tree using which classifier will classify the species of test data. The Decision Tree can be created as below.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=kn>from</span> <span class=nn>sklearn.datasets</span> <span class=kn>import</span> <span class=n>load_iris</span>
<span class=n>iris</span><span class=o>=</span><span class=n>load_iris</span><span class=p>()</span>
<span class=n>tree</span><span class=o>.</span><span class=n>export_graphviz</span><span class=p>(</span><span class=n>clf</span><span class=p>,</span>
<span class=n>out_file</span><span class=o>=</span><span class=s1>&#39;iris.dot&#39;</span><span class=p>,</span>  <span class=n>feature_names</span><span class=o>=</span><span class=n>iris</span><span class=o>.</span><span class=n>feature_names</span><span class=p>,</span>  
                         <span class=n>class_names</span><span class=o>=</span><span class=n>iris</span><span class=o>.</span><span class=n>target_names</span><span class=p>,</span>  
                         <span class=n>filled</span><span class=o>=</span><span class=bp>True</span><span class=p>,</span> <span class=n>rounded</span><span class=o>=</span><span class=bp>True</span><span class=p>,</span>  
                         <span class=n>special_characters</span><span class=o>=</span><span class=bp>True</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p><img class=lazyload src=/svg/loading/small.min.svg data-src=/images/ml_on_iris/iris7.png data-srcset="/images/ml_on_iris/iris7.png, /images/ml_on_iris/iris7.png 1.5x, /images/ml_on_iris/iris7.png 2x" data-sizes=auto alt=/images/ml_on_iris/iris7.png title=/images/ml_on_iris/iris7.png></p><p>We are using the graphviz and dot module to create a dot file which can be visualized using graphviz application. The tree we got is below.</p><p>Using the above tree the classifier will classify our test data. Remember the above tree is formed by the classifier using the training data.</p><h3 id=prediction>Prediction</h3><p><img class=lazyload src=/svg/loading/small.min.svg data-src=/images/ml_on_iris/iris8.jpg data-srcset="/images/ml_on_iris/iris8.jpg, /images/ml_on_iris/iris8.jpg 1.5x, /images/ml_on_iris/iris8.jpg 2x" data-sizes=auto alt=/images/ml_on_iris/iris8.jpg title=/images/ml_on_iris/iris8.jpg></p><p>We will use the ML model to predict the iris species on the test data.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>y_pred</span> <span class=o>=</span> <span class=p>(</span><span class=n>clf</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>))</span>
</code></pre></td></tr></table></div></div><p>We passed the X_test data to model get the prediction from our model and saved prediction as y_pred.</p><h3 id=performance>Performance</h3><p>We need to check the performance of our model on the test data. We will use accuracy as the performance measure.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=k>print</span> <span class=p>(</span><span class=s1>&#39;Accuracy Score&#39;</span><span class=p>);</span>
<span class=k>print</span> <span class=p>(</span><span class=n>accuracy_score</span><span class=p>(</span><span class=n>y_test</span><span class=p>,</span> <span class=n>y_pred</span><span class=p>)</span><span class=o>*</span> <span class=mi>100</span><span class=p>);</span>
</code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-fallback data-lang=fallback>#Accuracy Score
#95.5555555556
</code></pre></td></tr></table></div></div><p>This model got accuracy Score of 95.5556 out of 100.</p><h3 id=save-the-model>Save the model</h3><p>We need to save our ML model so that we can use it for deployment or in future use.In python model can be saved as pickle file with .pkl extension.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>joblib</span><span class=o>.</span><span class=n>dump</span><span class=p>(</span><span class=n>clf</span><span class=p>,</span> <span class=s1>&#39;iris.pkl&#39;</span><span class=p>)</span>
<span class=c1>#[&#39;iris.pkl&#39;]</span>
</code></pre></td></tr></table></div></div><p>We can load this .pkl file as below:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre class=chroma><code class=language-python data-lang=python><span class=n>clf2</span> <span class=o>=</span> <span class=n>joblib</span><span class=o>.</span><span class=n>load</span><span class=p>(</span><span class=s1>&#39;iris.pkl&#39;</span><span class=p>)</span>
<span class=n>clf2</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>X_test</span><span class=p>)</span>
</code></pre></td></tr></table></div></div><p>After loading the model we can use to predict the data as in above section.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>The article was updated on Monday, Sep 18, 2017</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back();>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/population_analysis/ class=prev rel=prev title="Population Analysis"><i class="fas fa-angle-left fa-fw"></i>Population Analysis</a>
<a href=/posts/eda_titanic/ class=next rel=next title="EDA on Titanic">EDA on Titanic<i class="fas fa-angle-right fa-fw"></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.69.2">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.8"><i class="far fa-kiss-wink-heart fa-fw"></i>LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2017 - 2020</span><span class=icp-splitter>&nbsp;|&nbsp;</span><br class=icp-br><span class=icp>Diwash Shrestha</span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw"></i></a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw"></i></a></div><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{}};</script><script type=text/javascript src=/js/theme.min.js></script></body></html>